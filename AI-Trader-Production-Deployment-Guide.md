# AI-Traderç”Ÿäº§ç¯å¢ƒç¨³å®šéƒ¨ç½²æŒ‡å—

> **éƒ¨ç½²æœ€ä½³å®è·µ** | æ‰“é€ 7Ã—24å°æ—¶ç¨³å®šè¿è¡Œçš„AIäº¤æ˜“ç³»ç»Ÿ

---

## ğŸ“‹ ç›®å½•

1. [éƒ¨ç½²æ¶æ„æ€»è§ˆ](#-éƒ¨ç½²æ¶æ„æ€»è§ˆ)
2. [æ¨èæ–¹æ¡ˆè¯¦è§£](#-æ¨èæ–¹æ¡ˆè¯¦è§£)
3. [å¤‡é€‰æ–¹æ¡ˆå¯¹æ¯”](#-å¤‡é€‰æ–¹æ¡ˆå¯¹æ¯”)
4. [ç¯å¢ƒå‡†å¤‡](#-ç¯å¢ƒå‡†å¤‡)
5. [å®æ–½æ­¥éª¤](#-å®æ–½æ­¥éª¤)
6. [ç›‘æ§ä¸ç»´æŠ¤](#-ç›‘æ§ä¸ç»´æŠ¤)
7. [æ•…éšœå¤„ç†](#-æ•…éšœå¤„ç†)
8. [æ€§èƒ½ä¼˜åŒ–](#-æ€§èƒ½ä¼˜åŒ–)

---

## ğŸŒŸ éƒ¨ç½²æ¶æ„æ€»è§ˆ

### ğŸ¯ æ ¸å¿ƒéœ€æ±‚åˆ†æ

åŸºäºAI-Traderçš„é¡¹ç›®ç‰¹æ€§ï¼Œé•¿æœŸç¨³å®šè¿è¡Œéœ€è¦æ»¡è¶³ï¼š

| éœ€æ±‚ç»´åº¦ | å…·ä½“è¦æ±‚ | é‡è¦æ€§ |
|----------|----------|--------|
| **ç¨³å®šæ€§** | 7Ã—24å°æ—¶è¿è¡Œï¼Œè‡ªåŠ¨æ•…éšœæ¢å¤ | â­â­â­â­â­ |
| **æ€§èƒ½** | é«˜å¹¶å‘AIæ¨ç†ï¼Œå®æ—¶æ•°æ®å¤„ç† | â­â­â­â­â­ |
| **å¯æ‰©å±•** | æ”¯æŒå¤šAIæ¨¡å‹ï¼Œæ°´å¹³æ‰©å±• | â­â­â­â­ |
| **å¯ç›‘æ§** | å®æ—¶çŠ¶æ€ç›‘æ§ï¼Œæ€§èƒ½æŒ‡æ ‡è¿½è¸ª | â­â­â­â­ |
| **æ˜“ç»´æŠ¤** | å¿«é€Ÿéƒ¨ç½²ï¼Œç‰ˆæœ¬å›æ»šï¼Œé…ç½®ç®¡ç† | â­â­â­â­ |

### ğŸ—ï¸ ç³»ç»Ÿç»„ä»¶åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AI-Trader ç³»ç»Ÿæ¶æ„                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŒ å‰ç«¯å±‚ (docs/)                                        â”‚
â”‚  â”œâ”€ HTML/CSS/JS é™æ€æ–‡ä»¶                                â”‚
â”‚  â””â”€ HTTPæœåŠ¡å™¨ (Python/Node.js/Nginx)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ§  åº”ç”¨å±‚ (main.py)                                      â”‚
â”‚  â”œâ”€ AIä»£ç†è°ƒåº¦å™¨                                        â”‚
â”‚  â”œâ”€ MCPå·¥å…·é“¾æœåŠ¡                                       â”‚
â”‚  â””â”€ APIæ¥å£ (RESTful/WebSocket)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¾ æ•°æ®å±‚ (data/)                                       â”‚
â”‚  â”œâ”€ äº¤æ˜“æ•°æ® (JSONLæ ¼å¼)                                â”‚
â”‚  â”œâ”€ æŒä»“è®°å½• (position.jsonl)                           â”‚
â”‚  â”œâ”€ AIæ—¥å¿— (log.jsonl)                                  â”‚
â”‚  â””â”€ ç¼“å­˜æ•°æ® (Rediså¯é€‰)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ¨èæ–¹æ¡ˆè¯¦è§£

### **æ–¹æ¡ˆä¸€ï¼šDocker + Docker Composeï¼ˆå¼ºçƒˆæ¨èâ­â­â­â­â­ï¼‰**

#### æ¶æ„å›¾

```mermaid
graph TB
    subgraph "å¤–éƒ¨è®¿é—®"
        A[ç”¨æˆ·æµè§ˆå™¨]
        B[åå‘ä»£ç† Nginx:80/443]
    end

    subgraph "Dockerç½‘ç»œ"
        C[Nginxå®¹å™¨<br/>åå‘ä»£ç† + é™æ€æ–‡ä»¶]
        D[AI-Traderä¸»å®¹å™¨<br/>Pythonåº”ç”¨ + MCPæœåŠ¡]
        E[Rediså®¹å™¨<br/>ç¼“å­˜æ•°æ®åº“]
        F[Prometheuså®¹å™¨<br/>ç›‘æ§æ•°æ®æ”¶é›†]
        G[Grafanaå®¹å™¨<br/>ç›‘æ§é¢æ¿]
    end

    subgraph "æ•°æ®å·"
        H[data_ai_trader<br/>äº¤æ˜“æ•°æ®]
        I[logs_ai_trader<br/>æ—¥å¿—æ•°æ®]
        J[cache_redis<br/>ç¼“å­˜æ•°æ®]
    end

    A --> B
    B --> C
    C --> D
    D --> E
    D --> F
    F --> G

    D --> H
    D --> I
    E --> J

    style D fill:#ff9800,color:#fff
    style C fill:#4caf50,color:#fff
    style E fill:#f44336,color:#fff
```

#### æ ¸å¿ƒä¼˜åŠ¿

âœ… **ç¯å¢ƒéš”ç¦»** - å®¹å™¨åŒ–ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§
âœ… **ä¸€é”®éƒ¨ç½²** - `docker-compose up -d` å¿«é€Ÿå¯åŠ¨
âœ… **è‡ªåŠ¨æ¢å¤** - å®¹å™¨å¼‚å¸¸è‡ªåŠ¨é‡å¯
âœ… **æ°´å¹³æ‰©å±•** - æ”¯æŒå¤šå®ä¾‹è´Ÿè½½å‡è¡¡
âœ… **ç‰ˆæœ¬ç®¡ç†** - é•œåƒç‰ˆæœ¬æ§åˆ¶ï¼Œå¿«é€Ÿå›æ»š
âœ… **èµ„æºç›‘æ§** - å®æ—¶ç›‘æ§å®¹å™¨èµ„æºä½¿ç”¨
âœ… **ç½‘ç»œéš”ç¦»** - å†…éƒ¨ç½‘ç»œï¼Œå®‰å…¨æ€§é«˜

#### æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ | ç”¨é€” |
|------|----------|------|------|
| **å®¹å™¨å¼•æ“** | Docker | 24.0+ | å®¹å™¨åŒ–å¹³å° |
| **ç¼–æ’å·¥å…·** | Docker Compose | 2.20+ | å®¹å™¨ç¼–æ’ |
| **åå‘ä»£ç†** | Nginx | 1.25-alpine | è´Ÿè½½å‡è¡¡ + SSL |
| **ç¼“å­˜** | Redis | 7.2-alpine | æ•°æ®ç¼“å­˜ |
| **ç›‘æ§** | Prometheus + Grafana | æœ€æ–°ç‰ˆ | ç³»ç»Ÿç›‘æ§ |
| **æ—¥å¿—** | Fluentd + ELK | å¯é€‰ | æ—¥å¿—æ”¶é›†åˆ†æ |

---

## ğŸ“Š å¤‡é€‰æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ

| æ–¹æ¡ˆ | ç¨³å®šæ€§ | æ˜“ç”¨æ€§ | æˆæœ¬ | æ‰©å±•æ€§ | ç›‘æ§èƒ½åŠ› | æ¨èåº¦ |
|------|--------|--------|------|--------|----------|--------|
| **Docker + Compose** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | **ğŸ¥‡å¼ºçƒˆæ¨è** |
| **Kubernetes** | â­â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | ğŸ¥ˆé€‚åˆå¤§è§„æ¨¡ |
| **PM2è¿›ç¨‹ç®¡ç†** | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­ | ğŸ¥‰é€‚åˆç®€å•åœºæ™¯ |
| **SystemdæœåŠ¡** | â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­ | â­â­ | ä»…å¼€å‘ç¯å¢ƒ |
| **äº‘åŸç”Ÿæ‰˜ç®¡** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | é¢„ç®—å……è¶³æ—¶ |

### å„æ–¹æ¡ˆè¯¦ç»†åˆ†æ

#### 1ï¸âƒ£ Docker + Docker Composeï¼ˆæœ€ä½³é€‰æ‹©ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- ä¸­å°å‹éƒ¨ç½²ï¼ˆ1-10å°æœåŠ¡å™¨ï¼‰
- éœ€è¦é«˜ç¨³å®šæ€§
- å›¢é˜Ÿæœ‰Dockerç»éªŒ
- å¿«é€Ÿè¿­ä»£å¼€å‘

**ä¸é€‚ç”¨åœºæ™¯**ï¼š
- è¶…å¤§è§„æ¨¡åˆ†å¸ƒå¼éƒ¨ç½²ï¼ˆ100+èŠ‚ç‚¹ï¼‰
- å›¢é˜Ÿå®Œå…¨æ— å®¹å™¨ç»éªŒ

#### 2ï¸âƒ£ Kubernetesï¼ˆå¤§è§„æ¨¡åœºæ™¯ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å¤§è§„æ¨¡åˆ†å¸ƒå¼éƒ¨ç½²
- éœ€è¦è‡ªåŠ¨ä¼¸ç¼©
- å¾®æœåŠ¡æ¶æ„å¤æ‚
- å›¢é˜Ÿæœ‰K8sç»éªŒ

**ä¸é€‚ç”¨åœºæ™¯**ï¼š
- å°å›¢é˜Ÿï¼Œèµ„æºæœ‰é™
- ç®€å•å•æœºéƒ¨ç½²éœ€æ±‚

#### 3ï¸âƒ£ PM2 + Nginxï¼ˆè½»é‡çº§æ–¹æ¡ˆï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- ç®€å•å•æœºéƒ¨ç½²
- å¿«é€Ÿä¸Šçº¿éœ€æ±‚
- å›¢é˜Ÿæ— å®¹å™¨ç»éªŒ
- èµ„æºå—é™ç¯å¢ƒ

**ä¸é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦å¤šå®ä¾‹å®¹é”™
- å¤æ‚ä¾èµ–ç®¡ç†

---

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡

### ç¡¬ä»¶è¦æ±‚

| éƒ¨ç½²è§„æ¨¡ | CPU | å†…å­˜ | ç£ç›˜ | ç½‘ç»œ |
|----------|-----|------|------|------|
| **å¼€å‘æµ‹è¯•** | 2æ ¸ | 4GB | 50GB | 100Mbps |
| **å°å‹ç”Ÿäº§** | 4æ ¸ | 8GB | 200GB | 1Gbps |
| **ä¸­å‹ç”Ÿäº§** | 8æ ¸ | 16GB | 500GB | 1Gbps |
| **å¤§å‹ç”Ÿäº§** | 16æ ¸+ | 32GB+ | 1TB+ | 10Gbps+ |

### è½¯ä»¶ä¾èµ–

```bash
# Ubuntu 22.04 LTS ç¤ºä¾‹
sudo apt update
sudo apt upgrade -y

# å®‰è£…Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# å®‰è£…Nginx
sudo apt install -y nginx

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
nginx -v
```

---

## ğŸš€ å®æ–½æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®ç»“æ„

```bash
# åˆ›å»ºç”Ÿäº§ç¯å¢ƒç›®å½•
mkdir -p /opt/ai-trader/{config,data,logs,scripts}
cd /opt/ai-trader

# å…‹éš†ä»£ç ï¼ˆä½¿ç”¨æ‚¨çš„ä»“åº“ï¼‰
git clone <your-repository-url> app
# æˆ–å¤åˆ¶æœ¬åœ°ä»£ç 
cp -r /path/to/AI-Trader/* app/
```

### ç¬¬äºŒæ­¥ï¼šç¼–å†™Docker Composeé…ç½®

åˆ›å»º `docker-compose.yml`ï¼š

```yaml
version: '3.8'

services:
  # Nginxåå‘ä»£ç†
  nginx:
    image: nginx:1.25-alpine
    container_name: ai-trader-nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./config/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./config/nginx/ssl:/etc/nginx/ssl:ro
      - ./app/docs:/usr/share/nginx/html:ro
    depends_on:
      - ai-trader-app
    networks:
      - ai-trader-network
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  # AI-Traderä¸»åº”ç”¨
  ai-trader-app:
    build:
      context: ./app
      dockerfile: Dockerfile
    container_name: ai-trader-app
    ports:
      - "8888:8888"
      - "8000:8000"
      - "8001:8001"
      - "8002:8002"
      - "8003:8003"
    volumes:
      - ai-trader-data:/app/data
      - ai-trader-logs:/app/logs
      - ./config:/app/config:ro
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - PYTHONUNBUFFERED=1
      - RUNTIME_ENV_PATH=/app/config/runtime_env.json
    networks:
      - ai-trader-network
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 4G
        reservations:
          cpus: '1'
          memory: 1G
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
        max-file: "5"

  # Redisç¼“å­˜
  redis:
    image: redis:7.2-alpine
    container_name: ai-trader-redis
    ports:
      - "6379:6379"
    volumes:
      - ai-trader-cache:/data
      - ./config/redis/redis.conf:/etc/redis/redis.conf:ro
    command: redis-server /etc/redis/redis.conf
    networks:
      - ai-trader-network
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  # ç›‘æ§ - Prometheus
  prometheus:
    image: prom/prometheus:latest
    container_name: ai-trader-prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./config/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
      - ai-trader-prometheus:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/etc/prometheus/console_libraries'
      - '--web.console.templates=/etc/prometheus/consoles'
    networks:
      - ai-trader-network
    restart: unless-stopped

  # ç›‘æ§ - Grafana
  grafana:
    image: grafana/grafana:latest
    container_name: ai-trader-grafana
    ports:
      - "3000:3000"
    volumes:
      - ai-trader-grafana:/var/lib/grafana
      - ./config/grafana/provisioning:/etc/grafana/provisioning:ro
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin123
    networks:
      - ai-trader-network
    restart: unless-stopped

  # æ—¥å¿—æ”¶é›† - Fluentdï¼ˆå¯é€‰ï¼‰
  fluentd:
    image: fluent/fluentd:latest
    container_name: ai-trader-fluentd
    volumes:
      - ./config/fluentd/fluent.conf:/fluentd/etc/fluent.conf:ro
      - ai-trader-logs:/fluentd/log
    networks:
      - ai-trader-network
    restart: unless-stopped

networks:
  ai-trader-network:
    driver: bridge

volumes:
  ai-trader-data:
    driver: local
  ai-trader-logs:
    driver: local
  ai-trader-cache:
    driver: local
  ai-trader-prometheus:
    driver: local
  ai-trader-grafana:
    driver: local
```

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºDockerfile

åˆ›å»º `app/Dockerfile`ï¼š

```dockerfile
FROM python:3.10-slim

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    curl \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .

# å®‰è£…Pythonä¾èµ–
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºæ•°æ®ç›®å½•
RUN mkdir -p /app/data /app/logs

# æš´éœ²ç«¯å£
EXPOSE 8888 8000 8001 8002 8003

# å¯åŠ¨å‘½ä»¤
CMD ["python3", "main.py", "configs/astock_config.json"]
```

### ç¬¬å››æ­¥ï¼šåˆ›å»ºNginxé…ç½®

åˆ›å»º `config/nginx/nginx.conf`ï¼š

```nginx
events {
    worker_connections 1024;
}

http {
    upstream ai_trader_backend {
        server ai-trader-app:8888;
    }

    # HTTPé‡å®šå‘åˆ°HTTPS
    server {
        listen 80;
        server_name _;
        return 301 https://$host$request_uri;
    }

    # HTTPSé…ç½®
    server {
        listen 443 ssl http2;
        server_name your-domain.com;

        # SSLè¯ä¹¦
        ssl_certificate /etc/nginx/ssl/ai-trader.crt;
        ssl_certificate_key /etc/nginx/ssl/ai-trader.key;

        # SSLå®‰å…¨é…ç½®
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
        ssl_prefer_server_ciphers off;

        # é™æ€æ–‡ä»¶
        location / {
            root /usr/share/nginx/html;
            try_files $uri $uri/ /index.html;
        }

        # APIä»£ç†
        location /api/ {
            proxy_pass http://ai_trader_backend/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # WebSocketæ”¯æŒ
        location /ws/ {
            proxy_pass http://ai_trader_backend;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }

        # å¥åº·æ£€æŸ¥
        location /health {
            access_log off;
            return 200 "healthy\n";
            add_header Content-Type text/plain;
        }
    }
}
```

### ç¬¬äº”æ­¥ï¼šç¼–å†™å¯åŠ¨è„šæœ¬

åˆ›å»º `scripts/deploy.sh`ï¼š

```bash
#!/bin/bash
set -e

echo "ğŸš€ å¼€å§‹éƒ¨ç½²AI-Traderç”Ÿäº§ç¯å¢ƒ..."

# åœæ­¢ç°æœ‰å®¹å™¨
echo "ğŸ“¦ åœæ­¢ç°æœ‰å®¹å™¨..."
docker-compose down

# æ¸…ç†æœªä½¿ç”¨é•œåƒ
echo "ğŸ§¹ æ¸…ç†æœªä½¿ç”¨é•œåƒ..."
docker image prune -f

# æ„å»ºæ–°é•œåƒ
echo "ğŸ”¨ æ„å»ºDockeré•œåƒ..."
docker-compose build --no-cache

# å¯åŠ¨æœåŠ¡
echo "â–¶ï¸ å¯åŠ¨æœåŠ¡..."
docker-compose up -d

# ç­‰å¾…æœåŠ¡å¯åŠ¨
echo "â³ ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 30

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
echo "ğŸ” æ£€æŸ¥æœåŠ¡çŠ¶æ€..."
docker-compose ps

# æ˜¾ç¤ºæ—¥å¿—
echo "ğŸ“‹ æŸ¥çœ‹æœåŠ¡æ—¥å¿—..."
docker-compose logs --tail=50

echo "âœ… éƒ¨ç½²å®Œæˆï¼"
echo "ğŸŒ è®¿é—®åœ°å€: http://your-domain.com"
echo "ğŸ“Š ç›‘æ§é¢æ¿: http://your-domain.com:3000 (admin/admin123)"
```

### ç¬¬å…­æ­¥ï¼šåˆå§‹åŒ–ç›‘æ§é…ç½®

åˆ›å»º `config/prometheus/prometheus.yml`ï¼š

```yaml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  # - "first_rules.yml"
  # - "second_rules.yml"

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  - job_name: 'ai-trader-app'
    static_configs:
      - targets: ['ai-trader-app:8888']
    metrics_path: '/metrics'
    scrape_interval: 5s

  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']
    metrics_path: '/metrics'
    scrape_interval: 5s

  - job_name: 'nginx'
    static_configs:
      - targets: ['nginx:80']
    metrics_path: '/nginx_status'
    scrape_interval: 5s
```

---

## ğŸ“Š ç›‘æ§ä¸ç»´æŠ¤

### ç›‘æ§æŒ‡æ ‡ä½“ç³»

#### 1. ç³»ç»Ÿç›‘æ§

| æŒ‡æ ‡ | é˜ˆå€¼ | ç›‘æ§æ–¹å¼ |
|------|------|----------|
| **CPUä½¿ç”¨ç‡** | <80% | Prometheus |
| **å†…å­˜ä½¿ç”¨ç‡** | <85% | Prometheus |
| **ç£ç›˜ä½¿ç”¨ç‡** | <90% | Prometheus |
| **ç½‘ç»œæµé‡** | ç›‘æ§å¼‚å¸¸å³°å€¼ | Prometheus |
| **å®¹å™¨çŠ¶æ€** | æ­£å¸¸è¿è¡Œ | Docker API |

#### 2. åº”ç”¨ç›‘æ§

| æŒ‡æ ‡ | é˜ˆå€¼ | ç›‘æ§æ–¹å¼ |
|------|------|----------|
| **å“åº”æ—¶é—´** | <500ms | Grafana |
| **é”™è¯¯ç‡** | <1% | è‡ªå®šä¹‰æŒ‡æ ‡ |
| **äº¤æ˜“æˆåŠŸç‡** | >99% | ä¸šåŠ¡ç›‘æ§ |
| **AIæ¨ç†å»¶è¿Ÿ** | <10s | è‡ªå®šä¹‰æŒ‡æ ‡ |
| **æ•°æ®æ›´æ–°é¢‘ç‡** | æ¯å°æ—¶ | Cronä»»åŠ¡ |

### å‘Šè­¦é…ç½®

åˆ›å»º `config/alertmanager.yml`ï¼š

```yaml
global:
  smtp_smarthost: 'smtp.example.com:587'
  smtp_from: 'alerts@ai-trader.com'

route:
  group_by: ['alertname']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: 'web.hook'
  routes:
    - match:
        severity: critical
      receiver: 'critical-alerts'

receivers:
  - name: 'web.hook'
    webhook_configs:
      - url: 'http://your-webhook-url'

  - name: 'critical-alerts'
    email_configs:
      - to: 'admin@ai-trader.com'
        subject: 'AI-Trader ä¸¥é‡å‘Šè­¦'
```

### æ—¥å¸¸ç»´æŠ¤ä»»åŠ¡

#### æ¯æ—¥ä»»åŠ¡

```bash
#!/bin/bash
# æ¯æ—¥ç»´æŠ¤è„šæœ¬ - scripts/daily_maintenance.sh

# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# 2. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker-compose logs --since=24h | grep ERROR

# 3. æ¸…ç†æ—§æ—¥å¿—
find /app/logs -name "*.log" -mtime +7 -delete

# 4. æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# 5. å¤‡ä»½é‡è¦æ•°æ®
tar -czf /backup/ai-trader-$(date +%Y%m%d).tar.gz /app/data

# 6. æ›´æ–°ç›‘æ§æ•°æ®
curl -X POST http://grafana:3000/api/dashboards/db
```

#### æ¯å‘¨ä»»åŠ¡

```bash
#!/bin/bash
# æ¯å‘¨ç»´æŠ¤è„šæœ¬ - scripts/weekly_maintenance.sh

# 1. æ¸…ç†Dockerèµ„æº
docker system prune -f

# 2. æ›´æ–°ä¾èµ–åŒ…
pip list --outdated

# 3. æ€§èƒ½æŠ¥å‘Š
docker stats --no-stream

# 4. å®‰å…¨æ‰«æ
docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
    aquasec/trivy image ai-trader:latest
```

---

## ğŸ”§ æ•…éšœå¤„ç†

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. å®¹å™¨å¯åŠ¨å¤±è´¥

```bash
# è¯Šæ–­æ­¥éª¤
docker-compose logs ai-trader-app
docker inspect ai-trader-app
docker exec -it ai-trader-app bash

# å¸¸è§åŸå› 
# - ç«¯å£è¢«å ç”¨ -> ä¿®æ”¹docker-compose.ymlç«¯å£æ˜ å°„
# - ç¯å¢ƒå˜é‡ç¼ºå¤± -> æ£€æŸ¥.envæ–‡ä»¶
# - æƒé™é—®é¢˜ -> æ£€æŸ¥æ•°æ®å·æƒé™
# - ä¾èµ–æœåŠ¡æœªå¯åŠ¨ -> ä½¿ç”¨docker-compose up -dä¾èµ–é¡ºåºå¯åŠ¨
```

#### 2. æœåŠ¡å“åº”æ…¢

```bash
# è¯Šæ–­æ­¥éª¤
docker stats
top
htop
iotop

# ä¼˜åŒ–æªæ–½
# - å¢åŠ å®¹å™¨èµ„æºé™åˆ¶
# - å¯ç”¨Redisç¼“å­˜
# - ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
# - è°ƒæ•´Docker Composeé…ç½®
```

#### 3. æ•°æ®ä¸¢å¤±

```bash
# é¢„é˜²æªæ–½
# - ä½¿ç”¨æ•°æ®å·æŒä¹…åŒ–
# - å®šæœŸè‡ªåŠ¨å¤‡ä»½
# - é…ç½®RedisæŒä¹…åŒ–

# æ¢å¤æ­¥éª¤
# 1. åœæ­¢å®¹å™¨
docker-compose down

# 2. æ¢å¤æ•°æ®å·
docker volume create ai-trader-data
docker run --rm -v ai-trader-data:/data -v $(pwd)/backup:/backup \
    alpine tar -xzf /backup/ai-trader-20251210.tar.gz -C /data

# 3. é‡å¯å®¹å™¨
docker-compose up -d
```

### è‡ªåŠ¨æ•…éšœæ¢å¤

åˆ›å»º `scripts/health_check.sh`ï¼š

```bash
#!/bin/bash
# å¥åº·æ£€æŸ¥è„šæœ¬

MAX_RETRY=3
RETRY_COUNT=0

while [ $RETRY_COUNT -lt $MAX_RETRY ]; do
    # æ£€æŸ¥AI-Traderå¥åº·çŠ¶æ€
    if curl -f http://localhost:8888/health > /dev/null 2>&1; then
        echo "$(date): AI-TraderæœåŠ¡æ­£å¸¸"
        exit 0
    else
        echo "$(date): AI-TraderæœåŠ¡å¼‚å¸¸ï¼Œå°è¯•é‡å¯..."
        docker-compose restart ai-trader-app
        RETRY_COUNT=$((RETRY_COUNT + 1))
        sleep 10
    fi
done

echo "$(date): é‡å¯å¤±è´¥ï¼Œå‘é€å‘Šè­¦"
curl -X POST http://your-webhook-url -d "AI-TraderæœåŠ¡å®•æœº"

exit 1
```

å°†è„šæœ¬åŠ å…¥crontabï¼ˆæ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼‰ï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹å†…å®¹
*/5 * * * * /opt/ai-trader/scripts/health_check.sh >> /var/log/ai-trader-health.log 2>&1
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### Dockerä¼˜åŒ–

#### 1. é•œåƒä¼˜åŒ–

```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM python:3.10-slim as builder
WORKDIR /app
COPY requirements.txt .
RUN pip install --user -r requirements.txt

FROM python:3.10-slim
WORKDIR /app
COPY --from=builder /root/.local /root/.local
COPY . .
ENV PATH=/root/.local/bin:$PATH

# ä½¿ç”¨érootç”¨æˆ·
RUN useradd -m -u 1000 ai-trader && \
    chown -R ai-trader:ai-trader /app
USER ai-trader
```

#### 2. èµ„æºé™åˆ¶

```yaml
# docker-compose.yml
services:
  ai-trader-app:
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 4G
        reservations:
          cpus: '1'
          memory: 1G
    # è½¯é™åˆ¶
    mem_limit: 4g
    mem_reservation: 1g
    cpu_limit: "4"
    cpu_reservation: "1"
```

### åº”ç”¨ä¼˜åŒ–

#### 1. è¿æ¥æ± é…ç½®

```python
# è¿æ¥æ± é…ç½®ç¤ºä¾‹
import redis
from sqlalchemy import create_engine

# Redisè¿æ¥æ± 
redis_pool = redis.ConnectionPool(
    host='redis',
    port=6379,
    max_connections=100,
    socket_timeout=5,
    socket_connect_timeout=5
)

# æ•°æ®åº“è¿æ¥æ± 
engine = create_engine(
    'postgresql://user:pass@localhost/db',
    pool_size=20,
    max_overflow=30,
    pool_pre_ping=True,
    pool_recycle=3600
)
```

#### 2. å¼‚æ­¥å¤„ç†

```python
# å¼‚æ­¥å¤„ç†ç¤ºä¾‹
import asyncio
from concurrent.futures import ThreadPoolExecutor

async def process_trading_data():
    loop = asyncio.get_event_loop()
    with ThreadPoolExecutor(max_workers=10) as executor:
        tasks = [
            loop.run_in_executor(executor, process_single_data, data)
            for data in data_list
        ]
        results = await asyncio.gather(*tasks)
    return results
```

### æ•°æ®åº“ä¼˜åŒ–

#### Redisé…ç½®ä¼˜åŒ–

```conf
# config/redis/redis.conf
maxmemory 2gb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
```

---

## ğŸ“ˆ æ‰©å±•æ–¹æ¡ˆ

### æ°´å¹³æ‰©å±•

å½“ç³»ç»Ÿè´Ÿè½½å¢åŠ æ—¶ï¼Œå¯ä»¥è½»æ¾æ‰©å±•ï¼š

```yaml
# docker-compose.yml
services:
  ai-trader-app:
    deploy:
      replicas: 3  # è¿è¡Œ3ä¸ªå®ä¾‹
    ports:
      - "8888-8890:8888"
```

ä½¿ç”¨Nginxè´Ÿè½½å‡è¡¡ï¼š

```nginx
upstream ai_trader_backend {
    server ai-trader-app-1:8888;
    server ai-trader-app-2:8888;
    server ai-trader-app-3:8888;
}
```

### åˆ†å¸ƒå¼éƒ¨ç½²

å¯¹äºè¶…å¤§è§„æ¨¡éƒ¨ç½²ï¼Œæ¨èä½¿ç”¨Kubernetesï¼š

```yaml
# k8s-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ai-trader-app
spec:
  replicas: 5
  selector:
    matchLabels:
      app: ai-trader-app
  template:
    metadata:
      labels:
        app: ai-trader-app
    spec:
      containers:
      - name: ai-trader-app
        image: ai-trader:latest
        resources:
          requests:
            memory: "2Gi"
            cpu: "1"
          limits:
            memory: "4Gi"
            cpu: "2"
```

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥

- [ ] æœåŠ¡å™¨ç¡¬ä»¶é…ç½®æ»¡è¶³è¦æ±‚
- [ ] æ“ä½œç³»ç»Ÿå·²æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
- [ ] Dockerå’ŒDocker Composeå·²å®‰è£…
- [ ] åŸŸåå’ŒSSLè¯ä¹¦å·²å‡†å¤‡
- [ ] é˜²ç«å¢™ç«¯å£å·²å¼€æ”¾ï¼ˆ80, 443, 8888, 3000, 9090ï¼‰
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] æ•°æ®å¤‡ä»½ç­–ç•¥å·²åˆ¶å®š

### éƒ¨ç½²åæ£€æŸ¥

- [ ] æ‰€æœ‰å®¹å™¨æ­£å¸¸è¿è¡Œ
- [ ] å‰ç«¯é¡µé¢å¯è®¿é—®
- [ ] APIæ¥å£å“åº”æ­£å¸¸
- [ ] ç›‘æ§é¢æ¿å¯è®¿é—®
- [ ] å‘Šè­¦é…ç½®ç”Ÿæ•ˆ
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸
- [ ] å¤‡ä»½ä»»åŠ¡è¿è¡Œ
- [ ] å¥åº·æ£€æŸ¥è„šæœ¬è¿è¡Œ

### ä¸Šçº¿åæ£€æŸ¥

- [ ] è´Ÿè½½æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
- [ ] ç›‘æ§å‘Šè­¦æ­£å¸¸
- [ ] æ•…éšœæ¢å¤æœºåˆ¶æµ‹è¯•
- [ ] æ–‡æ¡£æ›´æ–°å®Œæˆ
- [ ] å›¢é˜ŸåŸ¹è®­å®Œæˆ

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼

- **æŠ€æœ¯æ–‡æ¡£**: `/opt/ai-trader/docs/`
- **æ—¥å¿—ä½ç½®**: `/opt/ai-trader/logs/`
- **ç›‘æ§é¢æ¿**: http://your-domain.com:3000
- **å‘Šè­¦é€šçŸ¥**: é‚®ä»¶/Webhook

### èµ„æºé“¾æ¥

- [Dockerå®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [Docker Composeæ–‡æ¡£](https://docs.docker.com/compose/)
- [Prometheusç›‘æ§](https://prometheus.io/docs/)
- [Grafanaä»ªè¡¨æ¿](https://grafana.com/docs/)

---

**æ€»ç»“**

Docker + Docker Composeæ˜¯AI-Traderç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„**æœ€ä½³é€‰æ‹©**ï¼Œå®ƒæä¾›äº†ï¼š
- âœ… å“è¶Šçš„ç¨³å®šæ€§
- âœ… ç®€å•çš„éƒ¨ç½²æµç¨‹
- âœ… å®Œå–„çš„ç›‘æ§ä½“ç³»
- âœ… çµæ´»çš„æ‰©å±•èƒ½åŠ›
- âœ… ä¼˜ç§€çš„ç»´æŠ¤æ€§

é€šè¿‡æœ¬æŒ‡å—çš„å®æ–½ï¼Œæ‚¨å¯ä»¥æ„å»ºä¸€ä¸ª7Ã—24å°æ—¶ç¨³å®šè¿è¡Œçš„AIäº¤æ˜“ç³»ç»Ÿã€‚

---

*Â© 2025 AI-Trader | ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—*
